<span id= "20184301">SQLServer 数据库查看各表的记录数</span>
----------

- 各表记录条数

```sql
SELECT a.name AS 表名,
       MAX(b.rows) AS 记录条数
FROM sysobjects AS a,
     sysindexes AS b
WHERE a.id = b.id
      AND a.xtype = 'u'
GROUP BY a.name
ORDER BY MAX(b.rows) DESC;
```
- 总记录条数

```sql
SELECT SUM(记录条数) AS 总记录数
FROM
(
    SELECT TOP 10000 a.name AS 表名,
                     MAX(b.rows) AS 记录条数
    FROM sysobjects a,
         sysindexes b
    WHERE a.id = b.id
          AND a.xtype = 'u'
    GROUP BY a.name
    ORDER BY MAX(b.rows) DESC
) t1;
```

<span id= "20184302">SQLServer 查询所有表名和表结构</span>

- 表名

```sql
SELECT name FROM sysobjects WHERE xtype = 'U';
```


- SQLServer查询某表的表结构

```sql
SELECT
	syscolumns.name,
	systypes.name,
	syscolumns.isnullable,
	syscolumns.length
FROM
	syscolumns,
	systypes
WHERE
	syscolumns.xusertype = systypes.xusertype
AND syscolumns.id = object_id('ISBG_HumanMap');
```

<span id= "20184303">SQLServer 数据库拷贝</span>

- 需求：将BJC_PDRC_UAT库直接备份生成生产库BJC_PDRC
- 步骤：
1. 分离数据库
2. 拷贝数据库文件（BJC_PDRC_UAT.mdf和BJC_PDRC.ldf），然后重命名（BJC_PDRC.mdf和BJC_PDRC.ldf）
3. 附加数据库为生产库

- 分离数据库

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0001.png)

- 分离提示

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0002.png)

- 分离前点击【脚本】按钮

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0003.png)

- 复制并重命名数据库文件

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0003.png)

- 准备附加数据库

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0004.png)

- 选择准备好的数据库文件

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0005.png)

- 设置正确的数据库库名称

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0006.png)

- 刷新就可以看到新的数据库了

![](https://coderdream.github.io/snapshot/sqlserverbackup/sqlserverbackup_0007.png)







